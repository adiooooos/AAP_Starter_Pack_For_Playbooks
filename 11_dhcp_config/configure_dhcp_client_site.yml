# ============================================================================
# Playbook: Configure DHCP Client
# ============================================================================
#
# Description:
#   Configure DHCP client using rhel-system-roles.network role.
#   This is the Red Hat recommended standardized, cross-version network
#   configuration method for Linux service automation.
#
# Author: GCG AAP SSA Team + v3.01 20260217
#
# License:
#   ðŸ“œ License Type: End User License Agreement (EULA)
#   ðŸ”’ Authorization: Subscription-based License
#
# ============================================================================
---
- name: Configure DHCP client
  hosts: dhcp_clients
  become: true
  gather_facts: true

  pre_tasks:
    - name: Validate OS compatibility (RHEL/CentOS 7/8/9)
      ansible.builtin.assert:
        that:
          - ansible_os_family == "RedHat"
          - ansible_distribution in ["RedHat", "CentOS", "Rocky", "AlmaLinux", "OracleLinux"]
          - ansible_distribution_major_version in ["7", "8", "9"]
        fail_msg: "Unsupported operating system. This playbook is not available for the current OS."
        success_msg: "OS compatibility check passed: {{ ansible_distribution }} {{ ansible_distribution_major_version }}"
      tags: [always]

    - name: Display host information for debugging
      ansible.builtin.debug:
        msg:
          - "Host: {{ inventory_hostname }}"
          - "OS: {{ ansible_distribution }} {{ ansible_distribution_version }}"
      tags: [debug, always]

  vars:
    # Define network connections to configure
    network_connections:
      # Create a connection named 'dhcp-connection' for eth1 interface
      - name: "dhcp-connection"
        ## change your interface name here!!! -GCG AAP SSA Team + v3.01 20260204
        interface_name: eth1  
        type: ethernet
        # Enable IPv4 auto-configuration (DHCP)
        ip:
          dhcp4: yes
          # Enable IPv6 auto-configuration (SLAAC + DHCPv6)
          auto6: yes
        state: up

  roles:
    - rhel-system-roles.network

